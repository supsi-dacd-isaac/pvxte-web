{% extends 'base.html' %}

{% block content %}
    {% if 'username' in session.keys() and session['username'] != '' %}
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <ul class="navbar-nav">
              <li class="nav-item active">
                <a class="nav-link"><h3>Simulation results:</h3></a>
              </li>
        </ul>
    </nav>

    <br>
    <div class="container">
        <div class="left">
            <table class="table-sm-list">
                <thead>
                    <tr>
                        <td colspan="3"> Buses and batteries sizing</td>
                    </tr>
                    <tr>
                        <td>Bus id:</td>
                        <td>Battery size [kWh]:</td>
                        <td>Battery packs:</td>
                    </tr>
                </thead>
                <tbody>
                    {% for bsize in data['df_bsize'].iterrows() %}
                        <tr>
                            <td>{{ bsize[1]['Bus id']|int }}</td>
                            <td>{{ bsize[1]['Battery size (kWh)']|int }}</td>
                            <td>{{ bsize[1]['Battery packs']|int }}</td>
                        </tr>
                    {% endfor %}
                </tbody>
                <thead>
                    <tr>
                        <td colspan="3">Drivers sizing:</td>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td colspan="2">Minimum number:</td>
                        <td>{{ data['min_num_drivers']|int }}</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="center">
            <table class="table-sm-list">
                <thead>
                <tr>
                    <td colspan="3">Investment costs:</td>
                </tr>
                <tr>
                    <td></td><td>Cost [CHF]</td><td>Lifetime [years]</td>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td>Bus:</td>
                    <td>{{ capex_features['capex_bus_cost']|int }}</td>
                    <td>{{ capex_features['capex_bus_lifetime']|int }}</td>
                </tr>
                <tr>
                    <td>Battery:</td>
                    <td>{{ capex_features['capex_battery_cost']|int }}</td>
                    <td>{{ capex_features['capex_battery_lifetime']|int }}</td>
                </tr>
                <tr>
                    <td>Charger:</td>
                    <td>{{ capex_features['capex_charger_cost']|int }}</td>
                    <td>{{ capex_features['capex_charger_lifetime']|int }}</td>
                </tr>
                <thead>
                <tr>
                    <td colspan="3"></td>
                </tr>
                </thead>
                <tr>
                    <td>Interest rate:</td>
                    <td colspan="2">{{ capex_features['capex_interest_rate']|int }} %</td>
                </tr>
                <tr>
                    <td>Additional fee:</td>
                    <td colspan="2">{{ capex_features['capex_charger_cost']|int }} CHF</td>
                </tr>
                <tr>
                    <td><b>CAPEX:</b></td>
                    <td colspan="2"><b>{{ capex_features['capex_cost']|int }} kCHF/year</b></td>
                </tr>
                </tbody>
            </table>
        </div>
        <div class="right">
            <table class="table-sm-list">
                <thead>
                <tr>
                    <td colspan="2">Operational costs:</td>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td>Energy tariff:</td>
                    <td colspan="2">{{ opex_features['opex_energy_tariff'] }} CHF/kWh</td>
                </tr>
                <tr>
                    <td>Buses maintenance:</td>
                    <td>{{ opex_features['opex_buses_maintainance'] }} CHF/km</td>
                </tr>
                <tr>
                    <td>Buses efficiency:</td>
                    <td>{{ opex_features['opex_buses_efficiency'] }} kWh/km</td>
                </tr>
                <tr>
                    <td>Annual usage:</td>
                    <td>{{ opex_features['opex_annual_usage'] }} km</td>
                </tr>
                <tr>
                    <td><b>OPEX:</b></td>
                    <td colspan="2"><b>{{ opex_features['opex_cost']|int }} kCHF/year</b></td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>

    <br>
    <div>
        <a class="nav-link"><h4>Plot section:</h4></a><br>
        <table class="table-sm-list">
            <tbody>
                <tr>
                    <td>
                        <img src="{{ url_for('static', filename='plot/') }}{{ session['id_user'] }}_{{ sim_metadata[2] }}.png" style="width:1080px;height:495px;">
                    </td>
                </tr>
                <tr><td></td></tr>
                <tr>
                    <td>
                        <img src="{{ url_for('static', filename='plot/') }}{{ session['id_user'] }}_{{ sim_metadata[2] }}_charge_profile.png" style="width:1080px;height:495px;">
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
    <br>
    <div>
        <a class="nav-link"><h4>Download section:</h4></a><br>
        <table class="table-sm-list">
            <tbody>
                <tr>
                    <td>Results:</td>
                    <td>
                        <a class="link-dark" href="{{ url_for('static', filename='output-df/') }}{{ session['id_user'] }}_{{ sim_metadata[2] }}.csv">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download" viewBox="0 0 16 16">
                                  <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>
                                  <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>
                            </svg>
                        </a>
                    </td>
                    <td>Raw data:</td>
                    <td>
                        <a class="link-dark" href="{{ url_for('static', filename='output/') }}{{ session['id_user'] }}_{{ sim_metadata[2] }}.zip">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download" viewBox="0 0 16 16">
                                  <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>
                                  <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>
                            </svg>
                        </a>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
    {% endif %}

{% endblock %}